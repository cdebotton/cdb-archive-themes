# Migration `20190814183534-make-deleted-optional`

This migration has been generated by Christian de Botton at 8/14/2019, 6:35:34 PM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."GalleryMedia" DROP COLUMN "media",ADD COLUMN "media" text   REFERENCES "public"."Media"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Gallery" DROP COLUMN "author",ADD COLUMN "author" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Media" DROP COLUMN "author",ADD COLUMN "author" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration 20190814172605-add-media-tables..20190814183534-make-deleted-optional
--- datamodel.dml
+++ datamodel.dml
@@ -13,9 +13,9 @@
   email     String    @unique
   password  String
   firstName String?
   lastName  String?
-  deleted   Boolean
+  deleted   Boolean   @default(false)
   createdAt DateTime  @default(now())
   updatedAt DateTime  @updatedAt
   lastLogin DateTime?
 }
@@ -25,9 +25,9 @@
   uri         String   @unique
   title       String
   description String
   author      User
-  deleted     Boolean
+  deleted     Boolean  @default(false)
   publishedAt DateTime @default(now())
   createdAt   DateTime @default(now())
   updatedAt   DateTime @updatedAt
 }
@@ -35,18 +35,18 @@
 model GalleryMedia {
   id          String   @default(cuid()) @unique @id
   gallery     Gallery
   media       Media
-  deleted     Boolean
+  deleted     Boolean  @default(false)
   publishedAt DateTime @default(now())
   createdAt   DateTime @default(now())
   updatedAt   DateTime @updatedAt
 }
 model Media {
   id        String   @default(cuid()) @unique @id
   author    User
-  deleted   Boolean
+  deleted   Boolean  @default(false)
   filetype  String
   path      String
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
```

## Photon Usage

You can use a specific Photon built for this migration (20190814183534-make-deleted-optional)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190814183534-make-deleted-optional'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
